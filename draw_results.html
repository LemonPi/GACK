<!DOCTYPE html>
<html>
<head>
<script id="results" type="text/plain">
cell1_moist 0
cell1_color_spring 1
cell1_color_summer 3
cell1_color_fall 3
cell1_height 0
cell2_moist 0
cell2_color_spring 0
cell2_color_summer 3
cell2_color_fall 3
cell2_height 0
cell3_moist 0
cell3_color_spring 3
cell3_color_summer 0
cell3_color_fall 3
cell3_height 0
cell4_moist 0
cell4_color_spring 3
cell4_color_summer 0
cell4_color_fall 3
cell4_height 0
cell5_moist 0
cell5_color_spring 0
cell5_color_summer 3
cell5_color_fall 3
cell5_height 0
cell6_moist 0
cell6_color_spring 2
cell6_color_summer 3
cell6_color_fall 3
cell6_height 0
cell7_moist 0
cell7_color_spring 3
cell7_color_summer 1
cell7_color_fall 3
cell7_height 0
cell8_moist 0
cell8_color_spring 1
cell8_color_summer 3
cell8_color_fall 3
cell8_height 0
cell9_moist 0
cell9_color_spring 2
cell9_color_summer 3
cell9_color_fall 3
cell9_height 0
cell10_moist 0
cell10_color_spring 0
cell10_color_summer 3
cell10_color_fall 3
cell10_height 0
cell11_moist 0
cell11_color_spring 3
cell11_color_summer 1
cell11_color_fall 3
cell11_height 0
cell12_moist 0
cell12_color_spring 2
cell12_color_summer 3
cell12_color_fall 3
cell12_height 0
cell13_moist 0
cell13_color_spring 1
cell13_color_summer 3
cell13_color_fall 3
cell13_height 0
cell14_moist 0
cell14_color_spring 1
cell14_color_summer 3
cell14_color_fall 3
cell14_height 0
cell15_moist 0
cell15_color_spring 0
cell15_color_summer 3
cell15_color_fall 3
cell15_height 0
cell16_moist 0
cell16_color_spring 1
cell16_color_summer 3
cell16_color_fall 3
cell16_height 0
cell17_moist 0
cell17_color_spring 3
cell17_color_summer 0
cell17_color_fall 3
cell17_height 0
cell18_moist 0
cell18_color_spring 0
cell18_color_summer 3
cell18_color_fall 3
cell18_height 0
cell19_moist 0
cell19_color_spring 2
cell19_color_summer 3
cell19_color_fall 3
cell19_height 0
cell20_moist 1
cell20_color_spring 3
cell20_color_summer 3
cell20_color_fall 0
cell20_height 1
cell21_moist 0
cell21_color_spring 0
cell21_color_summer 3
cell21_color_fall 3
cell21_height 0
cell22_moist 0
cell22_color_spring 1
cell22_color_summer 3
cell22_color_fall 3
cell22_height 0
cell23_moist 0
cell23_color_spring 3
cell23_color_summer 0
cell23_color_fall 3
cell23_height 0
cell24_moist 0
cell24_color_spring 1
cell24_color_summer 3
cell24_color_fall 3
cell24_height 0
cell25_moist 0
cell25_color_spring 2
cell25_color_summer 3
cell25_color_fall 3
cell25_height 0
cell26_moist 0
cell26_color_spring 3
cell26_color_summer 0
cell26_color_fall 3
cell26_height 0
cell27_moist 1
cell27_color_spring 3
cell27_color_summer 3
cell27_color_fall 2
cell27_height 0
cell28_moist 1
cell28_color_spring 3
cell28_color_summer 3
cell28_color_fall 0
cell28_height 1
cell29_moist 0
cell29_color_spring 0
cell29_color_summer 3
cell29_color_fall 3
cell29_height 0
cell30_moist 0
cell30_color_spring 3
cell30_color_summer 0
cell30_color_fall 3
cell30_height 0
cell31_moist 0
cell31_color_spring 1
cell31_color_summer 3
cell31_color_fall 3
cell31_height 1
cell32_moist 0
cell32_color_spring 2
cell32_color_summer 3
cell32_color_fall 3
cell32_height 0
cell33_moist 1
cell33_color_spring 3
cell33_color_summer 3
cell33_color_fall 0
cell33_height 1
cell34_moist 0
cell34_color_spring 2
cell34_color_summer 3
cell34_color_fall 3
cell34_height 0
cell35_moist 0
cell35_color_spring 1
cell35_color_summer 3
cell35_color_fall 3
cell35_height 0
cell36_moist 0
cell36_color_spring 2
cell36_color_summer 3
cell36_color_fall 3
cell36_height 0
cell37_moist 0
cell37_color_spring 1
cell37_color_summer 3
cell37_color_fall 3
cell37_height 0
cell38_moist 0
cell38_color_spring 0
cell38_color_summer 3
cell38_color_fall 3
cell38_height 0
cell39_moist 0
cell39_color_spring 3
cell39_color_summer 0
cell39_color_fall 3
cell39_height 0
</script>
<script type="text/plain" id="results2">
cell1_moist 0
cell1_color_spring 3
cell1_color_summer 3
cell1_color_fall 4
cell1_height 1
cell2_moist 0
cell2_color_spring 3
cell2_color_summer 4
cell2_color_fall 3
cell2_height 1
cell3_moist 1
cell3_color_spring 3
cell3_color_summer 0
cell3_color_fall 3
cell3_height 1
cell4_moist 0
cell4_color_spring 3
cell4_color_summer 5
cell4_color_fall 3
cell4_height 0
cell5_moist 0
cell5_color_spring 3
cell5_color_summer 4
cell5_color_fall 3
cell5_height 1
cell6_moist 0
cell6_color_spring 3
cell6_color_summer 3
cell6_color_fall 3
cell6_height 1
cell7_moist 0
cell7_color_spring 3
cell7_color_summer 3
cell7_color_fall 4
cell7_height 1
cell8_moist 0
cell8_color_spring 3
cell8_color_summer 5
cell8_color_fall 3
cell8_height 1
cell9_moist 0
cell9_color_spring 3
cell9_color_summer 3
cell9_color_fall 4
cell9_height 1
cell10_moist 0
cell10_color_spring 3
cell10_color_summer 4
cell10_color_fall 3
cell10_height 1
cell11_moist 0
cell11_color_spring 3
cell11_color_summer 5
cell11_color_fall 3
cell11_height 1
cell12_moist 0
cell12_color_spring 5
cell12_color_summer 3
cell12_color_fall 3
cell12_height 0
cell13_moist 0
cell13_color_spring 3
cell13_color_summer 3
cell13_color_fall 4
cell13_height 1
cell14_moist 0
cell14_color_spring 3
cell14_color_summer 3
cell14_color_fall 4
cell14_height 1
cell15_moist 0
cell15_color_spring 3
cell15_color_summer 4
cell15_color_fall 3
cell15_height 1
cell16_moist 0
cell16_color_spring 3
cell16_color_summer 3
cell16_color_fall 3
cell16_height 1
cell17_moist 0
cell17_color_spring 3
cell17_color_summer 5
cell17_color_fall 3
cell17_height 1
cell18_moist 0
cell18_color_spring 3
cell18_color_summer 4
cell18_color_fall 3
cell18_height 1
cell19_moist 0
cell19_color_spring 3
cell19_color_summer 3
cell19_color_fall 4
cell19_height 1
cell20_moist 0
cell20_color_spring 3
cell20_color_summer 5
cell20_color_fall 3
cell20_height 1
cell21_moist 0
cell21_color_spring 5
cell21_color_summer 3
cell21_color_fall 3
cell21_height 0
cell22_moist 0
cell22_color_spring 3
cell22_color_summer 3
cell22_color_fall 3
cell22_height 1
cell23_moist 0
cell23_color_spring 3
cell23_color_summer 5
cell23_color_fall 3
cell23_height 1
cell24_moist 0
cell24_color_spring 3
cell24_color_summer 3
cell24_color_fall 3
cell24_height 1
cell25_moist 0
cell25_color_spring 3
cell25_color_summer 3
cell25_color_fall 4
cell25_height 1
cell26_moist 0
cell26_color_spring 3
cell26_color_summer 5
cell26_color_fall 3
cell26_height 1
cell27_moist 0
cell27_color_spring 4
cell27_color_summer 3
cell27_color_fall 3
cell27_height 0
cell28_moist 0
cell28_color_spring 3
cell28_color_summer 4
cell28_color_fall 3
cell28_height 1
cell29_moist 0
cell29_color_spring 5
cell29_color_summer 3
cell29_color_fall 3
cell29_height 0
cell30_moist 0
cell30_color_spring 4
cell30_color_summer 3
cell30_color_fall 3
cell30_height 0
cell31_moist 0
cell31_color_spring 3
cell31_color_summer 5
cell31_color_fall 3
cell31_height 1
cell32_moist 0
cell32_color_spring 3
cell32_color_summer 3
cell32_color_fall 4
cell32_height 1
cell33_moist 0
cell33_color_spring 3
cell33_color_summer 4
cell33_color_fall 3
cell33_height 1
cell34_moist 0
cell34_color_spring 3
cell34_color_summer 3
cell34_color_fall 4
cell34_height 1
cell35_moist 0
cell35_color_spring 3
cell35_color_summer 3
cell35_color_fall 3
cell35_height 1
cell36_moist 0
cell36_color_spring 3
cell36_color_summer 5
cell36_color_fall 3
cell36_height 1
cell37_moist 0
cell37_color_spring 3
cell37_color_summer 3
cell37_color_fall 4
cell37_height 1
cell38_moist 0
cell38_color_spring 3
cell38_color_summer 4
cell38_color_fall 3
cell38_height 1
cell39_moist 0
cell39_color_spring 3
cell39_color_summer 5
cell39_color_fall 3
cell39_height 0
</script>
<script>
"use strict";
var cellCount = 39;
var drawId = 0;
var ctx, canvas, bedpos, bedgraph, mainImg, pixels, pixelsData;
var colors = [0xffebee, 0xffcdd2, 0xef9a9a, 0xe57373,
0xef5350, 0xf44336, 0xe53935, 0xd32f2f,
0xc62828, 0xb71c1c, 0xfce4ec, 0xf8bbd0,
0xf48fb1, 0xf06292, 0xec407a, 0xe91e63,
0xd81b60, 0xc2185b, 0xad1457, 0x880e4f,
0xf3e5f5, 0xe1bee7, 0xce93d8, 0xba68c8,
0xab47bc, 0x9c27b0, 0x8e24aa, 0x7b1fa2,
0x6a1b9a, 0x4a148c, 0xede7f6, 0xd1c4e9,
0xb39ddb, 0x9575cd, 0x7e57c2, 0x673ab7,
0x5e35b1, 0x512da8, 0x4527a0];
var plantColorMap = [0xf44336, 0xff9800, 0xffeb3b, 0x8bc34a, 0x2196f3, 0x9c27b0];
var resultsSrc = "results";
function drawResult(colorForCell) {
	var d = pixelsData;
	var e = pixels.data;
	for (var i = 0; i < d.length; i += 4) {
		var myint = d[i] << 16 | d[i+1] << 8 | d[i+2];
		var pixindex = colors.indexOf(myint);
		if (pixindex != -1) {
			var c = colorForCell[pixindex];
			e[i] = (c >> 16) & 0xff;
			e[i+1] = (c >> 8) & 0xff;
			e[i+2] = c & 0xff;
		}
	}
	ctx.putImageData(pixels, 0, 0);
}
function loadhandler() {
	var counta = new Array(colors.length);
	for (var i = 0; i < colors.length; i++) counta[i] = 0;
	canvas = document.getElementById("maincanvas");
	mainImg = document.getElementById("mainimg");
	canvas.width = mainImg.width;
	canvas.height = mainImg.height;
	ctx = canvas.getContext("2d");
	ctx.drawImage(mainImg, 0, 0);
	pixels = ctx.getImageData(0, 0, canvas.width, canvas.height);
	var d = pixels.data;
	pixelsData = new Uint8ClampedArray(d);
	drawForSeason("spring");
}

function cellColorsForSeason(vars, season) {
	var outColors = new Array(cellCount);
	for (var i = 0; i < cellCount; i++) {
		var thecolor = vars["cell" + (i + 1) + "_color_" + season];
		if (thecolor == 3) {
			var height = vars["cell" + (i + 1) + "_height"];
			var heightMult = ((4-height) / 4)*0.40 + 0.60;
			var thecolor = plantColorMap[thecolor];
			var r = Math.min(0xff, (((thecolor >> 16) & 0xff) * heightMult)|0);
			var g = Math.min(0xff, (((thecolor >> 8) & 0xff) * heightMult)|0);
			var b = Math.min(0xff, (((thecolor) & 0xff) * heightMult)|0);
			outColors[i] = r << 16 | g << 8 | b;
		} else {
			outColors[i] = plantColorMap[thecolor];
		}
	}
	return outColors;
}

function getCellVars() {
	var d = document.getElementById(resultsSrc);
	var e = d.innerHTML.trim().split("\n");
	var vars = {};
	for (var i = 0; i < e.length; i++) {
		var f = e[i].split(" ");
		vars[f[0]] = f[1];
	}
	return vars;
}

function drawForSeason(season) {
	var vars = getCellVars();
	var colors = cellColorsForSeason(vars, season);
	drawResult(colors);
}
window.onload = loadhandler;
</script>
</head>
<body>
<canvas id="maincanvas" width="1024" height="1024"></canvas>
<img id="mainimg" src="flowerbed_coloured.png" style="display: none">
<button onclick="resultsSrc = 'results'">Results 1</button>
<button onclick="resultsSrc = 'results2'">Results 2</button>
<button onclick="drawForSeason('spring')">Spring</button>
<button onclick="drawForSeason('summer')">Summer</button>
<button onclick="drawForSeason('fall')">Fall</button>
</body>
</html>